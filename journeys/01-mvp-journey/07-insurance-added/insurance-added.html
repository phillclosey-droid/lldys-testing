<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- PWA Meta Tags for Full Screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    
        <!-- CRITICAL: Set theme BEFORE any CSS loads to prevent flicker -->
    <script>
        (function() {
            const savedTheme = localStorage.getItem('cancara-theme-preference') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
    
<title>Vehicle Insurance</title>
    
    <!-- Design Tokens -->
    <link rel="stylesheet" href="../../../src/css/cancara-tokens.css">
    
    <!-- Component Styles -->
    <link rel="stylesheet" href="../../../src/components/navigation/status-bar/StatusBar.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/navigation/header/custom-header/CustomHeader.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/navigation/bottom-nav/BottomNav.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/custom/mobility-mvp/service-alert/ServiceAlert.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/custom/mobility-mvp/service-hero-panel/ServiceHeroPanel.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/content/icon/pictogram/Pictogram.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/notification/notification-tag/NotificationTag.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/notification/notification-hint/NotificationHint.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/content/accordion/Accordion.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/action/button/action-button/ActionButton.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/content/divider/Divider.vanilla.css">
    <link rel="stylesheet" href="../../../src/components/notification/pop-up-modal/custom-pop-up-modal/CustomPopupModal.vanilla.css">
    <link rel="stylesheet" href="../../../src/templates/base-template/base-template.css">
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        html {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        body {
            position: fixed;
            width: 100%;
            height: 100%;
            font-family: var(--font-family-body);
            background: var(--color-gray-800);
            color: var(--text-default);
            transition: background-color 0.3s, color 0.3s;
            overflow: hidden;
        }
        
        .base-template {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            max-width: 100%;
            margin: 0;
        }
        
        @media (min-width: 431px) {
            .base-template {
                max-width: 430px;
                left: 50%;
                transform: translateX(-50%);
            }
        }
        
        @media (max-width: 430px) {
            .theme-toggle {
                display: none;
            }
        }
        
        /* Service Alert Container - Add margin bottom */
        .content-section:has(.service-alert) {
            margin-bottom: var(--spacing-24);
            width: 100%;
        }
        
        /* Hero Panel Container - Add margin bottom */
        .content-section:has(.service-hero-panel) {
            margin-top: 0;
            margin-bottom: var(--spacing-24);
            width: 100%;
        }
        
        /* Remove gap from content-container */
        .content-container {
            gap: 0 !important;
        }
        
        /* Add spacing above section titles */
        .section-title {
            margin-top: var(--spacing-32) !important;
        }
        
        /* Add spacing above accordion */
        .accordion {
            margin-top: var(--spacing-16);
        }
        
        /* Content Section */
        .content-section {
            padding: 0 var(--spacing-16);
            width: 100%;
        }
        
        /* Section Title - Type Style 3 */
        .section-title {
            font-family: var(--font-family-heading);
            font-size: var(--type-style-3-size);
            font-weight: var(--type-style-3-weight);
            line-height: var(--type-style-3-line-height);
            letter-spacing: var(--type-style-3-letter-spacing);
            color: var(--text-default);
            margin-top: var(--spacing-24);
            margin-bottom: var(--spacing-16);
        }
        
        /* Policy Details Row */
        .policy-detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-12) 0;
            border-bottom: 1px solid var(--border-default);
        }
        
        .policy-detail-row:last-child {
            border-bottom: none;
        }
        
        .policy-detail-label {
            font-family: var(--font-family-body);
            font-size: var(--type-style-6-size);
            font-weight: var(--font-weight-regular);
            line-height: var(--type-style-6-line-height);
            color: var(--text-subdued);
        }
        
        .policy-detail-value {
            font-family: var(--font-family-body);
            font-size: var(--type-style-6-size);
            font-weight: var(--font-weight-regular);
            line-height: var(--type-style-6-line-height);
            color: var(--text-default);
            text-align: right;
        }
        
        .policy-details-container {
            width: 100%;
        }
        
        /* Modal initially hidden */
        .popup-modal-overlay {
            display: none;
        }
    </style>
</head>
<body data-theme="dark">
    <script>
        (function() {
            const savedTheme = localStorage.getItem('cancara-theme-preference') || 'dark';
            document.body.setAttribute('data-theme', savedTheme);
        })();
    </script>
    <div class="theme-toggle">
        <button class="toggle-button" onclick="toggleTheme()">
            <span id="theme-text">Switch to Light Mode</span>
        </button>
    </div>

    <div class="base-template">
        <div class="header-wrapper">
            <div class="custom-header">
                <div class="status-bar status-bar-ios">
                    <div class="status-bar-time">9:41</div>
                    <div class="status-bar-levels">
                        <div class="cellular-signal">
                            <div class="signal-bar signal-bar-1"></div>
                            <div class="signal-bar signal-bar-2"></div>
                            <div class="signal-bar signal-bar-3"></div>
                            <div class="signal-bar signal-bar-4"></div>
                            <div class="signal-bar signal-bar-5"></div>
                        </div>
                        <div class="wifi-indicator">
                            <div class="wifi-dot"></div>
                            <div class="wifi-arc wifi-arc-1"></div>
                            <div class="wifi-arc wifi-arc-2"></div>
                            <div class="wifi-arc wifi-arc-3"></div>
                        </div>
                        <div class="status-bar-battery">
                            <div class="battery-border"></div>
                            <div class="battery-capacity"></div>
                            <div class="battery-tip"></div>
                        </div>
                    </div>
                </div>

                <div class="header-bar">
                    <div class="header-leading">
                        <div class="hit-target" onclick="navigateBack()" style="cursor: pointer;">
                            <div class="icon-wrapper icon-18">
                                <img id="back-icon" src="" alt="Back">
                            </div>
                        </div>
                        <div class="header-gap"></div>
                        <div class="empty-space"></div>
                    </div>

                    <div class="header-title-wrapper">
                        <div class="header-title">Vehicle insurance</div>
                    </div>

                    <div class="header-trailing">
                        <div class="empty-space"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="content-container">
                
                <div class="content-section">
                    <div class="service-alert">
                        <div class="service-alert-content">
                            <div class="service-alert-top">
                                <div class="service-alert-icon-container">
                                    <div class="service-alert-icon">
                                        <img src="../../../assets/icons/date-and-time/clock.svg" alt="">
                                    </div>
                                </div>
                                
                                <div class="service-alert-main">
                                    <div class="service-alert-title">Your insurance expires in 29 days</div>
                                    <div class="service-alert-text">Go to 'Manage policy' and let us know what you want to do next.</div>
                                </div>
                                
                                <button class="service-alert-close" aria-label="Close alert">
                                    <img src="../../../assets/icons/navigation/close.svg" alt="">
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="service-hero-panel">
                        <div class="service-hero-panel-pictogram">
                            <div class="pictogram pict-default">
                                <img src="../../../assets/icons/security/shield.svg" alt="">
                            </div>
                        </div>
                        
                        <div class="service-hero-panel-card">
                            <div class="service-hero-panel-reg-row">
                                <span class="service-hero-panel-reg-label">Renault Rafale</span>
                                <span class="service-hero-panel-pips">|</span>
                                <span class="service-hero-panel-reg-number">VX73 TZB</span>
                            </div>
                            
                            <div class="service-hero-panel-service-type">Insurance expires</div>
                            
                            <div class="service-hero-panel-date-row">
                                <div class="service-hero-panel-date">21 Nov 2026</div>
                                <div class="notification-tag tag-warning">
                                    <div class="notification-tag-text">29 days</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: var(--spacing-16);">
                                <button class="action-button btn-primary" onclick="window.CustomPopupModalComponent.show('modal-manage-policy')">
                                    <div class="action-button-inner">
                                        <span class="action-button-text">Manage policy</span>
                                        <div class="action-button-icon">
                                            <img data-icon="arrow-right" data-icon-category="arrows" alt="">
                                        </div>
                                    </div>
                                </button>
                            </div>
                            
                            <div class="service-hero-panel-divider">
                                <div class="divider width-fullwidth type-default">
                                    <div class="divider-line"></div>
                                </div>
                            </div>
                            
                            <div class="service-hero-panel-accordion">
                                <div class="accordion accordion-full accordion-single">
                                    <div class="accordion-item">
                                        <div class="accordion-header">
                                            <div class="accordion-icon-left">
                                                <img src="../../../assets/icons/navigation/notifications.svg" alt="">
                                            </div>
                                            <div class="accordion-label">
                                                <div class="accordion-label-text">Manage reminder</div>
                                            </div>
                                            <div class="accordion-icon">
                                                <div class="accordion-icon-plus">
                                                    <img src="../../../assets/icons/action/plus.svg" alt="">
                                                </div>
                                                <div class="accordion-icon-minus">
                                                    <img src="../../../assets/icons/action/minus.svg" alt="">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-panel">
                                            <div class="accordion-panel-content">
                                                <div class="service-hero-panel-cost-container">
                                                    <div class="service-hero-panel-cost-row">
                                                        <span class="service-hero-panel-cost-label">Insured until</span>
                                                        <span class="service-hero-panel-cost-value">21 Nov 2026</span>
                                                    </div>
                                                    
                                                    <div class="divider width-fullwidth type-dash">
                                                        <div class="divider-line"></div>
                                                    </div>
                                                    
                                                    <div class="service-hero-panel-cost-row">
                                                        <span class="service-hero-panel-cost-label">Reminder</span>
                                                        <span class="service-hero-panel-cost-value">21 Sep 2026</span>
                                                    </div>
                                                </div>
                                                
                                                <div class="service-hero-panel-button">
                                                    <button class="action-button btn-secondary">
                                                        <div class="action-button-inner">
                                                            <span class="action-button-text">Turn reminder off</span>
                                                            <div class="action-button-icon">
                                                                <img src="../../../assets/icons/edit/delete.svg" alt="">
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h2 class="section-title">Policy details</h2>
                    
                    <div class="policy-details-container">
                        <div class="policy-detail-row">
                            <span class="policy-detail-label">Provider</span>
                            <span class="policy-detail-value">Lloyds Bank</span>
                        </div>
                        
                        <div class="policy-detail-row">
                            <span class="policy-detail-label">Expiry date</span>
                            <span class="policy-detail-value">30 June 2025</span>
                        </div>
                        
                        <div class="policy-detail-row">
                            <span class="policy-detail-label">Policy type</span>
                            <span class="policy-detail-value">Comprehensive</span>
                        </div>
                        
                        <div class="policy-detail-row">
                            <span class="policy-detail-label">Cost</span>
                            <span class="policy-detail-value">Â£640</span>
                        </div>
                        
                        <div class="policy-detail-row">
                            <span class="policy-detail-label">Payment type</span>
                            <span class="policy-detail-value">Annual</span>
                        </div>
                        
                        <div class="policy-detail-row">
                            <span class="policy-detail-label">Policy number</span>
                            <span class="policy-detail-value">ABC123456789</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="nav-wrapper">
            <div class="bottom-nav" id="bottom-nav">
                <div class="bottom-nav-active-border">
                    <div class="active-border-segment active"></div>
                    <div class="active-border-segment"></div>
                    <div class="active-border-segment"></div>
                    <div class="active-border-segment"></div>
                    <div class="active-border-segment"></div>
                </div>
                
                <div class="bottom-nav-tabs">
                    <button class="bottom-nav-tab active" onclick="window.location.href='../01-account-summary/account-summary.html'">
                        <div class="bottom-nav-icon">
                            <img id="tab-icon-0-inactive" src="" alt="" class="icon-inactive">
                            <img id="tab-icon-0-active" src="" alt="" class="icon-active">
                        </div>
                        <span class="bottom-nav-label">Home</span>
                    </button>
                    
                    <button class="bottom-nav-tab" onclick="setActiveTab(1)">
                        <div class="bottom-nav-icon">
                            <img id="tab-icon-1-inactive" src="" alt="" class="icon-inactive">
                            <img id="tab-icon-1-active" src="" alt="" class="icon-active">
                        </div>
                        <span class="bottom-nav-label">Apply</span>
                    </button>
                    
                    <button class="bottom-nav-tab" onclick="setActiveTab(2)">
                        <div class="bottom-nav-icon">
                            <img id="tab-icon-2-inactive" src="" alt="" class="icon-inactive">
                            <img id="tab-icon-2-active" src="" alt="" class="icon-active">
                        </div>
                        <span class="bottom-nav-label">Payments</span>
                    </button>
                    
                    <button class="bottom-nav-tab" onclick="setActiveTab(3)">
                        <div class="bottom-nav-icon">
                            <img id="tab-icon-3-inactive" src="" alt="" class="icon-inactive">
                            <img id="tab-icon-3-active" src="" alt="" class="icon-active">
                        </div>
                        <span class="bottom-nav-label">Search</span>
                    </button>
                    
                    <button class="bottom-nav-tab" onclick="setActiveTab(4)">
                        <div class="bottom-nav-icon">
                            <img id="tab-icon-4-inactive" src="" alt="" class="icon-inactive">
                            <img id="tab-icon-4-active" src="" alt="" class="icon-active">
                        </div>
                        <span class="bottom-nav-label">Cards</span>
                    </button>
                </div>
                
                <div class="bottom-nav-home-indicator">
                    <div class="home-indicator-handle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Popup Modal -->
    <div class="popup-modal-overlay" id="modal-manage-policy">
        <div class="popup-modal sentiment-default link-layout-2horizontal">
            <div class="popup-modal-title">
                <div class="popup-modal-title-text">You're about to leave Lloyds banking</div>
            </div>
            <div class="popup-modal-body">
                <div class="popup-modal-message">We'll send you to our insurance website to manage your policy.</div>
            </div>
            <div class="popup-modal-buttons">
                <div class="popup-modal-divider"></div>
                <div class="popup-modal-buttons-container">
                    <button class="popup-modal-button">
                        <span class="popup-modal-button-text">Cancel</span>
                    </button>
                    <div class="popup-modal-separator"></div>
                    <button class="popup-modal-button">
                        <span class="popup-modal-button-text">Continue</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../../src/components/custom/mobility-mvp/service-alert/ServiceAlert.vanilla.js"></script>
    <script src="../../../src/components/custom/mobility-mvp/service-hero-panel/ServiceHeroPanel.vanilla.js"></script>
    <script src="../../../src/components/content/icon/pictogram/Pictogram.vanilla.js"></script>
    <script src="../../../src/components/notification/notification-hint/NotificationHint.vanilla.js"></script>
    <script src="../../../src/components/content/accordion/Accordion.vanilla.js"></script>
    <script src="../../../src/components/action/button/action-button/ActionButton.vanilla.js"></script>
    <script src="../../../src/components/notification/pop-up-modal/custom-pop-up-modal/CustomPopupModal.vanilla.js"></script>

    <script>
        const ASSETS_BASE = '../../../assets';
        
        const ICONS = {
            back: `${ASSETS_BASE}/icons/arrows/arrow-left.svg`,
            tab1: `${ASSETS_BASE}/icons/tabs/tab-1-icon.svg`,
            tab2: `${ASSETS_BASE}/icons/tabs/tab-2-icon.svg`,
            tab3: `${ASSETS_BASE}/icons/tabs/tab-3-icon.svg`,
            tab4: `${ASSETS_BASE}/icons/tabs/tab-4-icon.svg`,
            tab5: `${ASSETS_BASE}/icons/tabs/tab-5-icon.svg`,
            tab1Active: `${ASSETS_BASE}/icons/tabs/tab-1-icon-active.svg`,
            tab2Active: `${ASSETS_BASE}/icons/tabs/tab-2-icon-active.svg`,
            tab3Active: `${ASSETS_BASE}/icons/tabs/tab-3-icon-active.svg`,
            tab4Active: `${ASSETS_BASE}/icons/tabs/tab-4-icon-active.svg`,
            tab5Active: `${ASSETS_BASE}/icons/tabs/tab-5-icon-active.svg`
        };
        
        function initializeIcons() {
            const backIcon = document.getElementById('back-icon');
            if (backIcon) backIcon.src = ICONS.back;
            
            document.getElementById('tab-icon-0-inactive').src = ICONS.tab1;
            document.getElementById('tab-icon-1-inactive').src = ICONS.tab2;
            document.getElementById('tab-icon-2-inactive').src = ICONS.tab3;
            document.getElementById('tab-icon-3-inactive').src = ICONS.tab4;
            document.getElementById('tab-icon-4-inactive').src = ICONS.tab5;
            
            document.getElementById('tab-icon-0-active').src = ICONS.tab1Active;
            document.getElementById('tab-icon-1-active').src = ICONS.tab2Active;
            document.getElementById('tab-icon-2-active').src = ICONS.tab3Active;
            document.getElementById('tab-icon-3-active').src = ICONS.tab4Active;
            document.getElementById('tab-icon-4-active').src = ICONS.tab5Active;
        }

        function setActiveTab(tabIndex) {
            const nav = document.getElementById('bottom-nav');
            const tabs = nav.querySelectorAll('.bottom-nav-tab');
            const segments = nav.querySelectorAll('.active-border-segment');
            tabs.forEach(tab => tab.classList.remove('active'));
            segments.forEach(segment => segment.classList.remove('active'));
            tabs[tabIndex].classList.add('active');
            segments[tabIndex].classList.add('active');
        }

        function toggleTheme() {
            const body = document.body;
            const themeText = document.getElementById('theme-text');
            const currentTheme = body.getAttribute('data-theme');
            if (currentTheme === 'light') {
                body.setAttribute('data-theme', 'dark');
                themeText.textContent = 'Switch to Light Mode';
                localStorage.setItem('cancara-theme-preference', 'dark');
            } else {
                body.setAttribute('data-theme', 'light');
                themeText.textContent = 'Switch to Dark Mode';
                localStorage.setItem('cancara-theme-preference', 'light');
            }
        }
        
        function navigateBack() {
            // Get completed tasks from sessionStorage (set by hub page)
            const completed = sessionStorage.getItem('hubCompleted') || '';
            // Add a flag to indicate this is a return navigation
            sessionStorage.setItem('isReturningToHub', 'true');
            window.location.href = `../02-mobility-hub/mobility-hub.html${completed ? '?completed=' + completed : ''}`;
        }

        window.addEventListener('DOMContentLoaded', function() {
            // Update toggle text based on current theme
            const currentTheme = document.body.getAttribute('data-theme');
            const themeText = document.getElementById('theme-text');
            if (themeText) {
                if (currentTheme === 'dark') {
                    themeText.textContent = 'Switch to Light Mode';
                } else {
                    themeText.textContent = 'Switch to Dark Mode';
                }
            }
            
            initializeIcons();
            
            // Handle modal button clicks
            const modalOverlay = document.getElementById('modal-manage-policy');
            if (modalOverlay) {
                modalOverlay.addEventListener('popup-modal-button-click', function(e) {
                    // Button index 0 = Cancel, index 1 = Continue
                    if (e.detail.buttonIndex === 0) {
                        // Cancel button - close the modal
                        window.CustomPopupModalComponent.hide('modal-manage-policy');
                    }
                    // Continue button (index 1) doesn't need to do anything
                });
            }
        });
    </script>
</body>
</html>
